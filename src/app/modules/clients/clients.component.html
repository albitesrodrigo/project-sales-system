<div class="p-6 bg-gray-50 min-h-screen">
  <div
    class="flex flex-col md:flex-row md:items-center md:justify-between mb-8 gap-4"
  >
    <div>
      <h1 class="text-3xl font-bold text-gray-800 flex items-center mb-1">
        <i class="pi pi-users text-blue-600 mr-3 text-2xl"></i>
        GestiÃ³n de Clientes
      </h1>
      <p class="text-gray-600">
        Administra y consulta tus clientes registrados
      </p>
    </div>
    <div>
      <p-button
        icon="pi pi-user-plus"
        label="Agregar Cliente"
        severity="primary"
        class="shadow-md"
        (onClick)="showDialogCreateClient()"
      />
    </div>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
    <div
      class="bg-white rounded-lg shadow-md p-6 border-l-4 border-green-500 flex items-center"
    >
      <div class="bg-green-100 p-3 rounded-full mr-4">
        <i class="pi pi-users text-green-600 text-2xl"></i>
      </div>
      <div>
        <p class="text-gray-600 text-sm font-medium">Total Clientes</p>
        <p class="text-2xl font-bold text-gray-800">
          {{ clients.length || 0 }}
        </p>
      </div>
    </div>
  </div>
  <div class="rounded-lg shadow-md bg-white p-4">
    <p-table
      #dt
      [value]="clients"
      dataKey="id"
      [rows]="10"
      [rowsPerPageOptions]="[10, 25, 50]"
      [paginator]="true"
      [globalFilterFields]="['nombre', 'apellido', 'correo', 'telefono', 'dni']"
      showGridlines
    >
      <ng-template #caption>
        <div class="flex">
          <p-iconfield iconPosition="left" class="ml-auto">
            <p-inputicon>
              <i class="pi pi-search"></i>
            </p-inputicon>
            <input
              pInputText
              type="text"
              (input)="filterGlobal(dt, $event)"
              placeholder="Buscar"
            />
          </p-iconfield>
        </div>
      </ng-template>
      <ng-template #header>
        <tr>
          <th class="text-center">#</th>
          <th
            *ngFor="let col of columns"
            class="whitespace-nowrap font-bold"
            style="min-width: 5rem"
          >
            {{ col.header }}
            <p-columnFilter
              type="text"
              [field]="col.field"
              display="menu"
              class="icon-filter"
            />
          </th>
          <th class="font-bold text-center">Acciones</th>
        </tr>
      </ng-template>
      <ng-template #body let-cliente let-i="rowIndex">
        <tr>
          <td class="text-center">{{ i + 1 }}</td>
          <td *ngFor="let col of columns">
            {{ cliente[col.field] || "-" }}
          </td>
          <td>
            <div class="flex justify-center gap-2">
              <p-button
                icon="pi pi-pencil"
                severity="secondary"
                size="small"
                (click)="showDialogEditClient(cliente)"
                tooltip="Editar"
              />
              <p-button
                icon="pi pi-trash"
                severity="danger"
                size="small"
                (click)="trashClient(cliente, $event)"
                tooltip="Eliminar"
              />
            </div>
          </td>
        </tr>
      </ng-template>
      <ng-template #emptymessage>
        <tr>
          <td
            [attr.colspan]="columns.length + 2"
            class="text-center text-gray-400 py-8"
          >
            <i class="pi pi-info-circle mr-2"></i>
            No hay clientes registrados.
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>

<app-loading-spinner [loading]="loading"></app-loading-spinner>
<app-dialog-client
  [(visible)]="dialogVisible"
  (visibleChange)="dialogVisible = $event"
  [isEdit]="isEditing"
  [clientData]="dataEdit"
  (clientSaved)="onClientSaved($event)"
></app-dialog-client>
<p-toast />
<p-confirmdialog />
