<div class="p-6 bg-gray-50 min-h-screen">
  <!-- Cabecera -->
  <div
    class="flex flex-col md:flex-row md:items-center md:justify-between mb-8 gap-4"
  >
    <div>
      <h1 class="text-3xl font-bold text-gray-800 flex items-center mb-1">
        <i class="pi pi-shopping-cart text-orange-500 mr-3 text-2xl"></i>
        Gesti√≥n de Ventas
      </h1>
      <p class="text-gray-600">Administra y consulta tus ventas registradas</p>
    </div>
    <div>
      <p-button
        icon="pi pi-shopping-cart"
        label="Crear Venta"
        severity="primary"
        class="shadow-md"
        (onClick)="showDialogCreateSales()"
      />
    </div>
  </div>

  <!-- Tarjeta resumen -->
  <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
    <div
      class="bg-white rounded-lg shadow-md p-6 border-l-4 border-orange-500 flex items-center"
    >
      <div class="bg-orange-100 p-3 rounded-full mr-4">
        <i class="pi pi-shopping-cart text-orange-500 text-2xl"></i>
      </div>
      <div>
        <p class="text-gray-600 text-sm font-medium">Total Ventas</p>
        <p class="text-2xl font-bold text-gray-800">
          {{ sales.length || 0 }}
        </p>
      </div>
    </div>
  </div>

  <!-- Tabla de verntas -->
  <div class="rounded-lg shadow-md bg-white p-4">
    <p-table
      [value]="sales"
      dataKey="id"
      [paginator]="true"
      [rows]="10"
      [rowsPerPageOptions]="[10, 25, 50]"
      showGridlines
    >
      <ng-template pTemplate="header">
        <tr>
          <th>#</th>
          <th>Cliente</th>

          <th>Fecha</th>
          <th>Monto Total</th>
          <th class="w-40">Acciones</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-venta let-rowIndex="rowIndex">
        <tr>
          <td>{{ rowIndex + 1 }}</td>
          <td>{{ venta.cliente.nombre }} {{ venta.cliente.apellido }}</td>
          <td>{{ venta.fecha | date : "dd/MM/yyyy" }}</td>
          <td>S/ {{ venta.montoTotal | number : "1.2-2" }}</td>
          <td>
            <button
              pButton
              icon="pi pi-chevron-down"
              (click)="venta.expanded = !venta.expanded"
              [label]="venta.expanded ? 'Ocultar' : 'Ver Detalle'"
              class="p-button-text"
            ></button>
          </td>
        </tr>
        <tr *ngIf="venta.expanded">
          <td colspan="6">
            <p-table [value]="venta.detalles">
              <ng-template pTemplate="header">
                <tr>
                  <th>Producto</th>
                  <th>Precio</th>
                  <th>Cantidad</th>
                  <th>Subtotal</th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-detalle>
                <tr>
                  <td>{{ detalle.producto.nombre }}</td>
                  <td>S/ {{ detalle.producto.precio | number : "1.2-2" }}</td>
                  <td>{{ detalle.cantidad }}</td>
                  <td>S/ {{ detalle.subtotal | number : "1.2-2" }}</td>
                </tr>
              </ng-template>
            </p-table>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="6" class="text-center text-gray-400 py-8">
            <i class="pi pi-info-circle mr-2"></i>
            No hay ventas registradas.
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>
<app-dialog-sales
  [(visible)]="dialogVisible"
  [clients]="clients"
  [products]="products"
  (visibleChange)="dialogVisible = $event"
  (salesSaved)="onSalesSaved($event)"
></app-dialog-sales>
<p-toast />
<p-confirmdialog />
